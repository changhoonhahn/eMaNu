\documentclass[12pt, letterpaper, preprint]{aastex62}
\input{vc}
%\usepackage[breaklinks,colorlinks, urlcolor=blue,citecolor=blue,linkcolor=blue]{hyperref}
\usepackage{color}
\usepackage{amsmath}
\usepackage{natbib}
\usepackage{ctable}
\usepackage{bm}
\usepackage[normalem]{ulem} % Added by MS for \sout -> not required for final version
\usepackage{xspace}

% typesetting shih
\linespread{1.08} % close to 10/13 spacing
\setlength{\parindent}{1.08\baselineskip} % Bringhurst
\setlength{\parskip}{0ex}
\let\oldbibliography\thebibliography % killin' me.
\renewcommand{\thebibliography}[1]{%
  \oldbibliography{#1}%
  \setlength{\itemsep}{0pt}%
  \setlength{\parsep}{0pt}%
  \setlength{\parskip}{0pt}%
  \setlength{\bibsep}{0ex}
  \raggedright
}
\setlength{\footnotesep}{0ex} % seriously?

% citation alias

% math shih
\newcommand{\setof}[1]{\left\{{#1}\right\}}
\newcommand{\given}{\,|\,}
\newcommand{\lss}{{\small{LSS}}\xspace}

\newcommand{\Om}{\Omega_{\rm m}} 
\newcommand{\Ob}{\Omega_{\rm b}} 
\newcommand{\OL}{\Omega_\Lambda}
\newcommand{\smnu}{M_\nu}
\newcommand{\sig}{\sigma_8} 
\newcommand{\BOk}{\widehat{B}_0} 
\newcommand{\hmpc}{\,h/\mathrm{Mpc}}
\newcommand{\bfi}[1]{\textbf{\textit{#1}}}
\newcommand{\parti}[1]{\frac{\partial #1}{\partial \theta_i}}
\newcommand{\partj}[1]{\frac{\partial #1}{\partial \theta_j}}

\newcommand{\specialcell}[2][c]{%
  \begin{tabular}[#1]{@{}c@{}}#2\end{tabular}}
% text shih
\newcommand{\foreign}[1]{\textsl{#1}}
\newcommand{\etal}{\foreign{et~al.}}
\newcommand{\opcit}{\foreign{Op.~cit.}}
\newcommand{\documentname}{\textsl{Article}}
\newcommand{\equationname}{equation}
\newcommand{\bitem}{\begin{itemize}}
\newcommand{\eitem}{\end{itemize}}
\newcommand{\beq}{\begin{equation}}
\newcommand{\eeq}{\end{equation}}

%% MS: To make collaborating easier
\definecolor{orange}{rgb}{1,0.5,0}

%%% Here are the things that make collaborative effort easier
\newcommand{\ch}[1]{{\color{orange}{\bf CH:} #1}}

\begin{document}\sloppy\sloppypar\frenchspacing 

\title{Constraining $\smnu$ with the Bispectrum I: Breaking Parameter Degeneracies} 
\date{\texttt{DRAFT~---~\githash~---~\gitdate~---~NOT READY FOR DISTRIBUTION}}

\newcounter{affilcounter}
\author{ChangHoon Hahn}
\altaffiliation{hahn.changhoon@gmail.com}
\affil{Lawrence Berkeley National Laboratory, 1 Cyclotron Rd, Berkeley CA 94720, USA}
\affil{Berkeley Center for Cosmological Physics, University of California, Berkeley, CA 94720, USA}

\author{Francisco Villaescusa-Navarro} 
\affil{Center for Computational Astrophysics, Flatiron Institute, 162 5th Avenue, New York, NY 10010, USA} 

\author{Emanuele Castorina} 
\affil{Berkeley Center for Cosmological Physics, University of California, Berkeley, CA 94720, USA}
\affil{Lawrence Berkeley National Laboratory, 1 Cyclotron Rd, Berkeley CA 94720, USA}

\author{Roman Scoccimarro} 
\affil{Center for Cosmology and Particle Physics, Department of Physics, New York University, NY 10003, New York, USA}

\begin{abstract}
    Massive neutrinos suppress the growth of structure below their free-streaming scale and leave an 
    imprint on large-scale structure. Measuring this imprint allows us to constrain the sum of neutrino 
    masses, $\smnu$, a key ingredient for particle physics beyond the Standard Model. However, 
    degeneracies with cosmological parameters limit the constraining power of standard two-point clustering 
    statistics. In this work, we investigate whether we can break these parameter degerancies and constrain 
    $\smnu$ with the next higher-order correlation function, the bispectrum. We first examine the degeneracy 
    between $\smnu$ and $\sig$ using $800$ $N$-body simulations from the HADES suite and demonstrate that 
    the redshift-space halo bispectrum helps break this degeneracy.
    Next, we quantify the information content 
    of the redshift-space halo bispectrum in a Fisher matrix forecast that includes $\smnu$ and cosmological 
    parameters $\Om$, $\Ob$, $h$, $n_s$, and $\sig$. 
    This is the first $N$-body simulation based Fisher matrix forecast of cosmological parameters using the 
    bispectrum. More importantly, for $k_{\rm max} = 0.2$ and $0.5$ we find 
    %The combination of the three probes yield very tight constraints, allowing to place a ∼ 5σ bound on the minimum sum of the neutrino masses with a volume of just 1 (h−1Gpc)3 without CMB priors.
\end{abstract}

\keywords{
cosmology: 
---
}

\section{Introduction}
very brief into on neutrinos

Brief intro on the impact of massive active neutrinos on the matter powerspectrum 
and how that's detectable with CMB and LSS

Quick summary of current constraints and where they come from. Talk about the 
CMB-LSS lever arm. The degeneracy between As and tau and how that's a bottleneck
short thing about how $\tau$ is hard to constrain.

Fortunately the imprint of neutrinos on the matter distribution leaves imprints
on clustering. So with clustering measurements alone we can derive constraints 
on $\smnu$ and at the very least tighten constraints.  

Brief summary of previous works that look at the powerspectrum. Then Discuss the 
shortcomings of the powerspectrum only analysis-- Not good enough. 

However, we don't have to settle for just two point statistics, three-point 
statistics such as the bispectrum and 3PCF... 

In Section blah 

\ch{List plans for paper 2}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Section   
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{HADES and Quijote Simulation Suites} \label{sec:hades} 
We use a subset of the HADES\footnote{https://franciscovillaescusa.github.io/hades.html} 
and Quijote simulation suites. Below, we briefly describe these simulations; 
a brief summary of the simulations can be found in Table~\ref{tab:sims}. 
The HADES simulations start from Zel'dovich approximated initial conditions 
generated at $z=99$ using the~\cite{zennaro2017a} rescaling method and follow 
the gravitational evolution of $N_{\rm cdm}=512^3$ CDM, plus $N_{\nu}=512^3$ 
neutrino particles (for massive neutrino models), to $z=0$. They are run using 
the {\sc GADGET-III} TreePM+SPH code~\citep{springel2005} in a periodic 
$(1 h^{-1}{\rm Gpc})^3$ box. All of the HADES simulations share the following 
cosmological parameter values, which are in good agreement with Planck 
constraints~\cite{ade2016a}: $\Om{=}0.3175, \Ob{=}0.049, \OL{=}0.6825, n_s{=}0.9624, h{=}0.6711$, 
and $k_{\rm pivot} = 0.05~h{\rm Mpc}^{-1}$. 

The HADES suite includes models with degenerate massive neutrinos of different 
masses: $\smnu = $ 0.06, 0.10, and 0.15 eV. These massive neutrino models are run 
using the ``particle method'', where neutrinos are described as a collisionless 
and pressureless fluid and therefore modeled as particles, same as 
CDM~\citep{brandbyge2008,viel2010}. HADES also includes models with massless 
neutrino and different values of $\sigma_8$ to examine the $\smnu-\sigma_8$ 
degeneracy. The $\sigma_8$ values were chosen to match either $\sigma_8^m$ or 
$\sigma_8^{c}$ --- $\sigma_8$ computed with respect to total matter 
(CDM + baryons + $\nu$) or CDM + baryons --- of the massive neutrino models: 
$\sigma_8 = 0.822, 0.818, 0.807$, and $0.798$. Each model has $100$ independent 
realizations and we focus on the snapshots saved at $z = 0$. Halos closely 
trace the CDM+baryon field rather than the total matter field and neutrinos 
have negligible contribution to halo masses~\citep[\emph{e.g.}][]{ichiki2012, castorina2014, loverde2014, villaescusa-navarro2014}.
Hence, dark matter halos are identified in each realization using the Friends-of-Friends 
algorithm~\cite[FoF;][]{davis1985} with linking length $b=0.2$ on the CDM + baryon
distribution; only halos with masses $> 3.2\times 10^{13} h^{-1}M_\odot$ 
are included. For further details on the HADES simulations, we refer readers 
to~\cite{villaescusa-navarro2018}. 

In addition to HADES, we use simulations from the Quijote simulation suite, a
set of 23,000 $N$-body simulations that in total contain more than 3.3 trillion 
($3.3\times10^{12}$) particles over a volume of $23000 (h^{-1}{\rm Gpc})^3$. 
These simulations were constructed to quantify the information content of 
different cosmological observables using Fisher matrix forecasting~(\emph{e.g.} 
Section~\ref{sec:forecasts}). They are therefore designed to accurately calculate 
the covariance matrices of observables and the derivatives of observables with 
respect to cosmological parameters. The suite considers 6 cosmological parameters: 
$\Om$, $\Ob$, $h$, $n_s$, $\sig$, and $\smnu$.

To calculate covariance matrices, Quijote includes 15,000 $N$-body simulations 
run at a fiducial cosmology ($\Om{=}0.3175$, $\Ob{=}0.049$, $h{=}0.6711$, 
$n_s{=}0.9624$, $\sig{=}0.834$, and $\smnu{=}0.0$ eV). It also includes sets 
of 500 $N$-body simulations run at different cosmologies where only one parameter 
is varied from the fiducial cosmology at a time for the derivatives. Along $\Om$, 
$\Ob$, $h$, $n_s$, and $\sig$, the fiducial cosmology is adjusted by either a 
small step above and below the fiducial value. Along $\smnu$, because the 
derivative of certain observable with respect to $\smnu$ is noisy, Quijote 
includes sets of 500 simulations for $\smnu = 0.1$, 0.2, and 0.4 eV. In 
Table~\ref{tab:sims}, we list the cosmologies included in the Quijote suite. 

The intial conditions for all Quijote simulations were generated at $z=127$ using 
2LPT for simulations with massless neutrinos and the Zel’dovich approximation for 
massive neutrinos. Like HADES, the initial conditions of simulations with massive
neutrinos take their scale-dependent growth factors/rates into account using the
\cite{zennaro2017a} method. From the initial conditions, all of the simulations 
follow the gravitational evolution of $512^3$ dark matter particles, and $512^3$ 
neutrino particles (for massive neutrino models), to $z=0$ using {\sc Gadget-III}
TreePM+SPH code (same as HADES). The simulations run at the fiducial cosmology for 
covariance matrix estimation are standard $N$-body simulations. However, the rest 
are paired fixed simulations, which greatly reduce cosmic variance without introducing 
bias for a large set of statistics~\citep{angulo2016,pontzen2016,villaescusa-navarro2018}. 
We confirm that the paired fixed simulations do not introduce any bias for the 
redshift-space halo bispectrum (the observable we consider in this paper). For 
further details on the Quijote simulations, we refer readers to 
Villaescusa-Navarro et al. (in preparation). 

\begin{figure}
\begin{center}
\includegraphics[width=0.9\textwidth]{figs/haloPlk_rsd_ratio.pdf}
    \caption{Impact of $\smnu$ and $\sig$ on the redshift-space halo power 
    spectrum monopole and quadrupole measured using the HADES simulation suite. 
    $\smnu$ and $\sig$ produce almost identical effects on halo clustering on 
    small scales ($k > 0.1\hmpc$). This degeneracy can be partially broken 
    through the quadrupole; however, {\em $\smnu$ and $\sig$ produce almost 
    the same effect on two-point clustering --- within a few percent}.
    }
\label{fig:plk}
\end{center}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% simulation table
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{table}
\caption{Specifications of the HADES and Quijote simulation suites.} 
\begin{center}
\begin{tabular}{ccccccccc} \toprule
    Name  &$\smnu$ & $\Omega_m$ & $\Omega_b$ & $h$ & $n_s$ & $\sigma^m_8$ & $\sigma^c_8$ & realizations \\
      &({\footnotesize eV}) & & & & & ({\footnotesize $10^{10}h^{-1}M_\odot$}) & ({\footnotesize $10^{10}h^{-1}M_\odot$}) & \\[3pt] \hline\hline
    \multicolumn{9}{c}{HADES suite} \\ \hline
    Fiducial    & 0.0   & 0.3175 & 0.049 & 0.6711 & 0.9624 & 0.833 & 0.833 & 100 \\ 
                & 0.06  & 0.3175 & 0.049 & 0.6711 & 0.9624 & 0.819 & 0.822 & 100 \\ 
                & 0.10  & 0.3175 & 0.049 & 0.6711 & 0.9624 & 0.809 & 0.815 & 100 \\ 
                & 0.15  & 0.3175 & 0.049 & 0.6711 & 0.9624 & 0.798 & 0.806 & 100 \\ 
                & 0.0   & 0.3175 & 0.049 & 0.6711 & 0.9624 & 0.822 & 0.822 & 100 \\ 
                & 0.0   & 0.3175 & 0.049 & 0.6711 & 0.9624 & 0.818 & 0.818 & 100 \\ 
                & 0.0   & 0.3175 & 0.049 & 0.6711 & 0.9624 & 0.807 & 0.807 & 100 \\ 
                & 0.0   & 0.3175 & 0.049 & 0.6711 & 0.9624 & 0.798 & 0.798 & 100 \\[3pt]
    \hline \hline
    \multicolumn{9}{c}{Qujiote suite} \\ \hline
    Fiducial 	    & 0.0         & 0.3175 & 0.049 & 0.6711 & 0.9624 & 0.834 & 0.834 & 15,000 \\ 
    $\smnu^+$       & \underline{0.1}   & 0.3175 & 0.049 & 0.6711 & 0.9624 & 0.834 & 0.834 & 500 \\ 
    $\smnu^{++}$    & \underline{0.2}   & 0.3175 & 0.049 & 0.6711 & 0.9624 & 0.834 & 0.834 & 500 \\ 
    $\smnu^{+++}$   & \underline{0.4}   & 0.3175 & 0.049 & 0.6711 & 0.9624 & 0.834 & 0.834 & 500 \\ 
    $\Omega_m^+$    & 0.0   & \underline{ 0.3275} & 0.049 & 0.6711 & 0.9624 & 0.834 & 0.834 & 500 \\ 
    $\Omega_m^-$    & 0.0   & \underline{ 0.3075} & 0.049 & 0.6711 & 0.9624 & 0.834 & 0.834 & 500 \\ 
    $\Omega_b^+$    & 0.0   & 0.3175 & \underline{0.050} & 0.6711 & 0.9624 & 0.834 & 0.834 & 500 \\ 
    $\Omega_b^-$    & 0.0   & 0.3175 & \underline{0.048} & 0.6711 & 0.9624 & 0.834 & 0.834 & 500 \\ 
    $h^+$           & 0.0   & 0.3175 & 0.049 & \underline{0.6911} & 0.9624 & 0.834 & 0.834 & 500 \\ 
    $h^-$           & 0.0   & 0.3175 & 0.049 & \underline{0.6511} & 0.9624 & 0.834 & 0.834 & 500 \\ 
    $n_s^+$         & 0.0   & 0.3175 & 0.049 & 0.6711 & \underline{0.9824} & 0.834 & 0.834 & 500 \\ 
    $n_s^-$         & 0.0   & 0.3175 & 0.049 & 0.6711 & \underline{0.9424} & 0.834 & 0.834 & 500 \\ 
    $\sigma_8^+$    & 0.0   & 0.3175 & 0.049 & 0.6711 & 0.9624 & \underline{0.849} & \underline{0.849} & 500 \\ 
    $\sigma_8^-$    & 0.0   & 0.3175 & 0.049 & 0.6711 & 0.9624 & \underline{0.819} & \underline{0.819} & 500 \\[3pt]
    \hline
\end{tabular} \label{tab:sims}
\end{center}
    {\bf Top}: The HADES suite includes sets of 100 $N$-body simulations with degenerate massive neutrinos 
    of $\smnu = $ 0.06, 0.10, and 0.15 eV as well as sets of simulations with massless neutrino and 
    $\sigma_8 = $ 0.822, 0.818, 0.807, and 0.798 to examine the $\smnu-\sigma_8$ degeneracy. 
    {\bf Bottom}: The Quijote suite includes 15,000 $N$-body simulations at the fiducial cosmology 
    to accurately estimate the covariance matrices. It also includes sets of 500 paired fixed simulations 
    at different cosmologies, where only one parameter is varied from the fiducial value (underlined), 
    to estimate derivatives of observables along the cosmological parameters.
\end{table}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}
\begin{center}
    \includegraphics[width=\textwidth]{figs/haloBk_shape_kmax05_rsd.pdf} 
    \caption{The redshift-space halo bispectrum, $\BOk(k_1, k_2, k_3)$, as a 
    function of triangle configuration shape for $\smnu = 0.0, 0.06, 0.10$, 
    and $0.15\,\mathrm{eV}$ (upper panels) and $\sig = 0.822, 0.818$, and 
    $0.807$ (lower panels). The HADES simulations of the top and bottom 
    panels in the three right-most columns, have matching $\sig$ values 
    (Section~\ref{sec:hades}). We describe the triangle configuration shape 
    by the ratio of the triangle sides: $k_3/k_1$ and $k_2/k_1$. The upper 
    left bin contains squeezed triangles ($k_1 = k_2 \gg k_3$); the upper 
    right bin contains equilateral triangles ($k_1 = k_2 = k_3$); and the 
    bottom center bin contains folded triangles ($k_1 = 2 k_2 = 2 k_3$). 
    We include all triangle configurations with $k_1, k_2, k_3 \leq k_{\rm max} = 0.5~h/{\rm Mpc}$. 
    and use the $\BOk$ estimator in Section~\ref{sec:bk}.}
\label{fig:bk_shape}
\end{center}
\end{figure}

\begin{figure}
\begin{center}
\includegraphics[width=0.9\textwidth]{figs/haloBk_amp_kmax05_rsd.pdf}
    \caption{The redshift-space halo bispectrum, $\BOk(k_1, k_2, k_3)$, as a
    function of triangle configurations for $\smnu = 0.0, 0.06, 0.10$, 
    and $0.15\,\mathrm{eV}$ (top panel) and $\smnu = 0.0$ eV, $\sig = 0.822, 0.818, 0.807$, 
    and $0.798$ (lower panel). We include all possible triangle configurations 
    with $k_1, k_2, k_3 \leq k_{\rm max} = 0.5~h/{\rm Mpc}$ where we order
    the configurations by looping through $k_3$ in the inner most loop and 
    $k_1$ in the outer most loop satisfying $k_1 \leq k_2 \leq k_3$. In the 
    insets of the panels we zoom into triangle configurations with 
    $k_1 = 0.113$, $0.226 \leq k_2 \leq 0.283$, and $0.283 \leq k_3 \leq 0.377~h/{\rm Mpc}$.}
\label{fig:bk_amp}
\end{center}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Section   
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Bispectrum} \label{sec:bk} 
We're interested in breaking parameter degeneracies that limit the constraining 
power on $\smnu$ of two-point clustering analyses using three-point clustering 
statistics --- \emph{i.e.} the bispectrum. In this section, we describe the 
bispectrum estimator used throughout the paper. We focus on the bispectrum monopole 
($\ell = 0$) and use an estimator that exploits Fast Fourier Transpforms (FFTs). 
Our estimator is similar to the estimators described in \cite{scoccimarro2015,sefusatti2016}; 
we also follow their formalism in our description below. Although \cite{sefusatti2016} 
and \cite{scoccimarro2015} respectively describe estimators in redshift- and real-space,  
since we focus on the bispectrum monopole, we note that there is no difference. 

To measure the bispectrum of our halo catalogs, we begin by interpolating the halo
positions to a grid, $\delta({\bfi x})$ and Fourier transforming the grid to get $\delta({\bfi k})$.
We use a fourth-order interpolation to interlaced grids, which has advantageous 
anti-aliasing properties~\citep{hockney1981,sefusatti2016} that allow unbias measurements 
up to the Nyquist frequency. Then using $\delta({\bfi k})$, we measure the bispectrum monopole as 
\beq \label{eq:bk} 
\widehat{B}_{\ell = 0}(k_1,k_2, k_3) = \frac{1}{V_B} \int\limits_{k_1}{\rm d}^3q_1 \int\limits_{k_2}{\rm d}^3q_2 \int\limits_{k_3}{\rm d}^3q_3~\delta_{\rm D}({\bfi q_{123}})~\delta({\bfi q_1})~\delta({\bfi q_2})~\delta({\bfi q_3}) - B^{\rm SN}_{\ell = 0}
\eeq
$\delta_{\rm D}$ above is a Dirac delta function and hence $\delta_{\rm D}({\bfi q_{123}}) = \delta_{\rm D}({\bfi q_1} + {\bfi q_2} + {\bfi q_3})$ 
ensures that the ${\bfi q}_i$ triplet actually form a closed triangle. Each of the integrals 
above represent an integral over a spherical shell in $k$-space with radius $\delta k$ 
centered at ${\bfi k}_i$ --- \emph{i.e.} 
\beq
\int_{k_i}{\rm d}^3q \equiv \int\limits_{k_i-\delta k/2}^{k_i+\delta k/2}{\rm d}q~q^2\int {\rm d}\Omega.
\eeq
$V_B$ is a normalization factor proportional to the number of triplets ${\bfi q_1}$, 
${\bfi q_2}$, and ${\bfi q_3}$ that can be found in the triangle bin defined by 
$k_1$, $k_2$, and $k_3$ with width $\delta k$: 
\beq
V_B = \int\limits_{k_1}{\rm d}^3q_1 \int\limits_{k_2}{\rm d}^3q_2 \int\limits_{k_3}{\rm d}^3q_3~\delta_{\rm D}({\bfi q_{123}})
\eeq
Lastly, $B^{\rm SN}_{\ell=0}$ is the correction for the Poisson shot noise, which 
contributes due to the self-correlation of individual objects: 
\beq \label{eq:bk_sn} 
B^{\rm SN}_{\ell=0}(k_1, k_2, k_3) = \frac{1}{\bar{n}} \big(P_0(k_1) + P_0(k_2) + P_0(k_3) \big) + \frac{1}{\bar{n}^2}. 
\eeq
$\bar{n}$ is the number density of objects (halos) and $P_0$ is the powerspectrum monopole. 

In order to evaluate the integrals in Eq.~\ref{eq:bk}, we take advantage of the plane-wave 
representation of the Dirac delta function and rewrite the equation as
\begin{align} \label{eq:bk2} 
    \widehat{B}_{\ell = 0}(k_1,k_2, k_3) &= \frac{1}{V_B} \int\frac{{\rm d}^3x}{(2\pi)^3} \int\limits_{k_1}{\rm d}^3q_1 \int\limits_{k_2}{\rm d}^3q_2 \int\limits_{k_3}{\rm d}^3q_3~\delta({\bfi q_1})~\delta({\bfi q_2})~\delta({\bfi q_3})~e^{i{\bfi q_{123}}\cdot{\bfi x}} - B^{\rm SN}_{\ell = 0}\\ 
    &= \frac{1}{V_B} \int\frac{{\rm d}^3x}{(2\pi)^3}\prod\limits_{i=1}^{3} I_{k_i}({\bfi x}) - B^{\rm SN}_{\ell = 0} 
\end{align}
where 
\beq
I_{k_i}({\bfi x}) = \int\limits_k {\rm d}^3q~\delta({\bfi q})~e^{i {\bfi q}\cdot{\bfi x}}. 
\eeq
At this point, we measure $\widehat{B}_{\ell = 0}(k_1, k_2, k_3)$ by calcuating the 
$I_{k_i}$s with inverse FFTs and summing over in real space.\footnote{The code that we use to 
evaluate $\widehat{B}_{\ell = 0}$ is publicly available at \url{https://github.com/changhoonhahn/pySpectrum}}
For $\widehat{B}_{\ell = 0}$
measurements throughout the paper, we use $\delta({\bfi x})$ grids with $N_{\rm grid} = 360$ 
and triangle configurations defined by $k_1, k_2, k_3$ bins of width 
$\Delta k = 3 k_f = 0.01885~h/{\rm Mpc}$.

We present the redshift-space halo bispectrum of the HADE simulations measured using 
the estimator above in two ways: one that emphasizes the triangle shape dependence 
(Figure~\ref{fig:bk_shape}) and the other that emphasizes the amplitude 
(Figure~\ref{fig:bk_amp}). In Figure~\ref{fig:bk_shape}, we plot $\BOk(k_1, k_2, k_3)$ 
as a function of $k_2/k_1$ and $k_3/k_1$, which describe the triangle configuration shape. 
In each panel, the colormap in each ($k_2/k_1$, $k_3/k_1$) bin is the weighted average $\BOk$ amplitude 
of all triangle configurations in the bin. The upper left bins contain squeezed triangles 
($k_1 = k_2 \gg k_3$); the upper right bins contain equilateral triangles 
($k_1 = k_2 = k_3$); and the bottom center bins contain folded triangles ($k_1 = 2 k_2 = 2 k_3$). 
We include all possible triangle configurations with $k_1, k_2, k_3 < k_{\rm max} = 0.5~h/{\rm Mpc}$. 
The $\BOk$ in the upper panels are HADES models with $\smnu = 0.0$ (fiducial), $0.06, 0.10$, 
and $0.15\,\mathrm{eV}$; $\BOk$ in the lower panels are  HADES models with $\smnu 0.0$ eV and 
$\sig = 0.822, 0.818$, and $0.807$. The top and bottom panels of the three right-most 
columns have matching $\sig$ values (Section~\ref{sec:hades}).

Next, in Figure~\ref{fig:bk_amp}, we plot $\BOk(k_1, k_2, k_3)$ for all possible triangle 
configurations with $k_1, k_2, k_3 < k_{\rm max} = 0.5~h/{\rm Mpc}$ where we order the 
configurations by looping through $k_3$ in the inner most loop and $k_1$ in the outer most 
loop with $k_1 \leq k_2 \leq k_3$. In the top panel, we present $\BOk$ of HADES models 
with $\smnu = 0.0, 0.06, 0.10$, and $0.15\,\mathrm{eV}$; in the lower panel, we present 
$\BOk$ of HADES models with $\smnu 0.0$ eV and $\sig = 0.822, 0.818$, and $0.807$. We 
zoom into triangle configurations with $k_1 = 0.113$, $0.226 \leq k_2 \leq 0.283$, 
and $0.283 \leq k_3 \leq 0.377~h/{\rm Mpc}$ in the insets of the panels. 

\begin{figure}
\begin{center}
\includegraphics[width=0.8\textwidth]{figs/haloBk_dshape_kmax05_rsd.pdf} 
    \caption{The shape dependence of the $\smnu$ and $\sig$ imprint on 
    the redshift-space halo bispectrum, $\Delta \BOk/\BOk^\mathrm{fid}$. 
    We align the $\smnu{=}~0.06, 0.10$, and $0.15\,\mathrm{eV}$ HADES models 
    in the upper panels with $\smnu{=}~0.0$~eV $\sig{=}~0.822$, $0.818$, and $0.807$ 
    models on the bottom such that the top and bottom panels in each column 
    have matching $\sig^{c}$, which produce mostly degenerate imprints on the 
    redshift-space power spectrum. The difference between the top and bottom 
    panels highlight that $\smnu$ leaves a distinct imprint on elongated and 
    isosceles triangles (bins along the bottom left and bottom right edges, 
    respectively) from $\sig$. {\em The imprint of $\smnu$ has an overall 
    distinct shape dependence on the bispectrum that cannot be replicated by 
    varying $\sig$}. 
    }
\label{fig:dbk_shape}
\end{center}
\end{figure}

\begin{figure}
\begin{center}
\includegraphics[width=0.9\textwidth]{figs/haloBk_residual_kmax05_rsd.pdf}
    \caption{The impact of $\smnu$ and $\sig$ on the redshift-space halo bispectrum,
    $\Delta \BOk/\BOk^\mathrm{fid}$, for all $1898$ triangle configurations with 
    $k_1, k_2, k_3 \leq 0.5 h/{\rm Mpc}$. We compare $\Delta \BOk/\BOk^\mathrm{fid}$ 
    of the $\smnu = 0.06$ (top), $0.10$ (middle), and $0.15$ eV (bottom) HADES models
    to $\Delta \BOk/\BOk^\mathrm{fid}$ of $\smnu{=}~0.0$ eV $\sig{=}~0.822$, $0.818$, and 
    $0.807$ models. The impact of $\smnu$ on the bispectrum has a significantly different 
    amplitude than the impact of $\sig$. For instance, $\smnu{=}~0.15\,\mathrm{eV}$ (red) 
    has a $\sim 5\%$ stronger impact on the bispectrum than $\smnu{=}~0.0$ eV  
    $\sig{=}~0.798$ (black) even though their powerspectrums only differ by $< 1\%$ 
    (Figure~\ref{fig:plk}). Combined with the different shape-dependence (Figure~\ref{fig:dbk_shape}), 
    {\em the distinct imprint of $\smnu$ on the bispectrum illustrate that the bispectrum 
    can break the degeneracy between $\smnu$ and $\sig$ 
    that degrade constraints from two-point analyses}.
    }
\label{fig:dbk_amp}
\end{center}
\end{figure}

%\begin{figure}
%\begin{center}
%\includegraphics[width=0.95\textwidth]{figs/haloBk_triangles_rsd.pdf}
%    \caption{The impact of $\smnu$ and $\sig$ on the redshift-space halo 
%    bispectrum, $\Delta B/B^\mathrm{(fid)}$, for triangles that have  
%    $[k_1, k_2] = [0.19, 0.11], [0.11, 0.11]$ and $[0.08, 0.06]~h/{\rm Mpc}$ 
%    (left to right) with different angles in between, $\theta_{12}$. Again, 
%    the HADES simulations with $\smnu{=}~0.06$, $0.10$, and $0.15$ eV 
%    (orange, green, red) have matching $\sig^{c}$ with the $\smnu{=}~0.0$ eV, 
%    $\sig{=}~0.822$, $0.818$, and $0.807$ (purple, pink, yellow dashed). Comparison
%    between  these two sets of simulations further illustrate the distinct 
%    imprint of the $\smnu$ on the bispectrum. We also include $\smnu{=}~0.0$ eV, 
%    $\sig{=}~0.798$ (black dashed) to highlight that change in $\sig$ cannot 
%    reproduce the imprint of $\smnu$. 
%    }
%\label{fig:dbk_amp}
%\end{center}
%\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Section   
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results} \label{sec:results} 
\subsection{Breaking the $\smnu$-- $\sig$ degeneracy} \label{sec:mnusig}
One major bottleneck of constraining $\smnu$ with the power spectrum alone is the 
strong $\smnu$ -- $\sig$ degeneracy. The imprint of $\smnu$ and $\sig$ on the power 
spectrum are degenerate and for models with the same $\sig^c$, the power spectrum
only differ by $< 1\%$ (see Figure~\ref{fig:plk} and~\citealt{villaescusa-navarro2018}). 
The HADES suite, which has simulations with $\smnu = 0.0, 0.06, 0.10$, 
and $0.15$ eV as well as $\smnu = 0.0$ eV simulations with matching $\sig^{c}$ --- 
$\sig{=}~0.822$, $0.818$, and $0.807$ , provide an ideal set of simulations to 
separate the impact of $\smnu > 0.0$ eV and examine the degeneracy between 
$\smnu$ and $\sig$ (Section~\ref{sec:hades} and Table~\ref{tab:sims}). Hence, by 
measuring bispectrum of these simulations (Figure~\ref{fig:bk_shape} and~\ref{fig:bk_amp}), 
we can determine whether the bispectrum helps break the $\smnu$ -- $\sig$ 
degeneracy. Below, we present our comparison of the HADES bispectrum and 
illustrate that the bispectrum can significantly improve $\smnu$ constraints 
by breaking the $\smnu$ -- $\sig$ degeneracy. 

We begin by examining the triangle shape dependent imprint of $\smnu$ on the 
redshift-space halo bispectrum versus $\sig$ alone. In Figure~\ref{fig:dbk_shape}, 
we present the fractional residual, $(\Delta \BOk = \BOk - \BOk^{\rm fid})/\BOk^{\rm fid}$,
as a function of $k_2/k_1$ and $k_3/k_1$ for $\smnu=0.06, 0.10$, and $0.15$~eV 
in the upper panels and 0.0~eV $\sig{=}~0.822$, $0.818$, and $0.807$ in the 
bottom panels. The simulations in the top and bottom panels of each column 
have matching $\sig^{c}$. Overall as $\smnu$ increases, the bispectrum increases 
for all triangle shapes (top panels). This increase is due to halo 
bias~\citep[][; see also Figure~\ref{fig:plk}]{villaescusa-navarro2018}. We 
impose a fixed $M_{\rm lim}$ on our halos so lower values of $\sig$ translate 
to a larger halo bias, which boosts the amplitude of the bispectrum. Within the 
overall increase in amplitude, however, equilateral triangles (upper left) have 
the largest increase. For $\smnu=0.15$ eV, the bispectrum is $\sim 15\%$ higher 
than $\BOk^{\rm fid}$ for equilateral triangles. Meanwhile, the bispectrum increases 
by $\sim 8\%$ for folded triangles for 0.15~eV (lower center). The noticeable 
difference in $\Delta \BOk/\BOk^{\rm fid}$ between equilateral and squeezed 
triangles (upper left) is roughly consistent with the comparison in Figure 7 
of~\cite{ruggeri2018}. They, however, fix $A_s$ in their simulations and 
measure the real-space halo bispectrum so we refrain from any detailed 
comparisons. 

As $\sig$ increases, with $\smnu = 0.0$ eV fixed, the bispectrum increases 
overall for all triangle shapes (bottom panels). However, the comparison of the
top and bottom panels in each column reveals significant differences in 
$\Delta \BOk/\BOk^{\rm fid}$ for $\smnu$ versus $\sig$ alone. Between 
$\smnu=0.15$ eV and $0.0$ eV $\sig = 0.807$, there is an overall $\gtrsim 5\%$ 
difference. In addition, the shape dependence of the $\Delta \BOk/\BOk^{\rm fid}$ 
increase is different for $\smnu$ than $\sig$. This is particularly clear in 
the differences between $0.1$ eV (top center panel) and 0.0 eV and $\sig=0.807$ 
(bottom right panel): near equilateral triangles in the two panels have similar 
$\Delta \BOk/\BOk^{\rm fid}$ while triangle shapes near the lower left edge from 
the squeezed to folded triangles have significantly different $\Delta \BOk/\BOk^{\rm fid}$. 
Hence, $\smnu$ leaves an imprint on the bispectrum with a distinct triangle 
shape dependence than $\sig$ alone. In other words, unlike the power spectrum, 
the triangle shape dependent impact of $\smnu$ on the bispectrum cannot be 
replicated by varying $\sig$. 

We next examine the amplitude of the $\smnu$ imprint on the redshift-space halo 
bispectrum versus $\sig$ alone for all triangle configurations. We present 
$\Delta \BOk/\BOk^{\rm fid}$ for all $1898$ possible triangle configurations 
with $k_1, k_2, k_3 < k_{\rm max} = 0.5~h/{\rm Mpc}$ in Figure~\ref{fig:dbk_amp}. 
We compare $\Delta \BOk/\BOk^{\rm fid}$ of the $\smnu = 0.06, 0.10$, and 
$0.15$ eV HADES models to the $\Delta \BOk/\BOk^\mathrm{fid}$ of 
$\smnu{=}~0.0$ eV $\sig{=}~0.822$, $0.818$, and $0.807$ models in the
top, middle, and bottom panels, respectively. The comparison confirms the 
difference in overall amplitude of varying $\smnu$ and $\sig$ (Figure~\ref{fig:dbk_shape}). 
For instance, $\smnu{=}~0.15\,\mathrm{eV}$ (red) has a $\sim 5\%$ stronger 
impact on the bispectrum than $\smnu{=}~0.0$ eV $\sig{=}~0.798$ (black) 
even though their power spectrums differ by $< 1\%$ (Figure~\ref{fig:plk}).

The comparison in the panels of Figure~\ref{fig:dbk_amp} also reveal a difference 
in the configuration dependence in $\Delta \BOk/\BOk^\mathrm{fid}$ between $\smnu$ 
versus $\sig$. The triangle configurations are ordered by looping through $k_3$ 
in the inner most loop and $k_1$ in the outer most loop such that $k_1 \leq k_2 \leq k_3$. 
In this ordering, $k_1$ increases from left to right. $\Delta \BOk/\BOk^\mathrm{fid}$ 
of $\smnu$ expectedly increases with $k_1$: for small $k_1$ (on large scales), 
neutrinos behave like CDM and therefore the impact is reduced. However, 
$\Delta \BOk/\BOk^\mathrm{fid}$ of $\smnu$ has a smaller $k_1$ dependence than 
$\Delta \BOk/\BOk^\mathrm{fid}$ of $\sig$. Combined with the different shape-dependence
(Figure~\ref{fig:dbk_shape}), the distinct imprint of $\smnu$ on the redshift-space 
halo bispectrum illustrates that the bispectrum can break the degeneracy between 
$\smnu$ and $\sig$. Moreover it illustrates that by including the bispectrum, we 
can more precisely constrain $\smnu$ than with the power spectrum alone. 

\begin{figure}
\begin{center}
    \includegraphics[width=0.6\textwidth]{figs/quijote_bkCov_kmax05.png} 
    \caption{Covariance matrix of the redshift-space halo bispectrum estimated 
    using the 15,000 realizations of the Qujiote simulation suite at the fiducial 
    cosmology: $\Om{=}0.3175$, $\Ob{=}0.049$, $h{=}0.6711$, $n_s{=}0.9624$, $\sig{=}0.834$, 
    and $\smnu{=}0.0$ eV. We include all possible triangle configurations with 
    $k_1, k_2, k_3 < k_{\rm max} = 0.5~h/{\rm Mpc}$ and order the configurations 
    (bins) in the same way as Figures~\ref{fig:bk_amp} and~\ref{fig:dbk_amp}. We 
    use the covariance matrix above for the Fisher matrix forecasts presented in 
    Section~\ref{sec:forecasts}. 
    }
\label{fig:bk_cov}
\end{center}
\end{figure}

\begin{figure}
\begin{center}
    \includegraphics[width=\textwidth]{figs/quijote_pbkFisher_freeMmin_dmnu_fin_kmax02.pdf}
    \caption{Fisher matrix constraints for $\smnu$ and other cosmological parameters 
    for the redshift-space halo bispectrum monopole (orange). For comparison, we 
    include Fisher parameter constraints for the redshift-space halo powerspectrum monopole 
    in blue. The contours mark the $68\%$ and $95\%$ confidence interals. We set 
    $k_{\rm max} = 0.2~h/{\rm Mpc}$ for both power spectrum and bispectrum. We 
    include in our forecasts $b'$ and $M_{\rm min}$, a free amplitude scaling factor
    and halo mass limit, respectively. They serve as a simplistic bias model and we 
    marginalize over them to that our constraints do not include extra constraining 
    power from the difference in bias/number density in the different Quijote cosmologies.
    The bispectrum {\em substantially} improves constraints on all of the cosmological parameters 
    over the power spectrum. {\em For $\smnu$, the bispectrum improves the constraint
    from $\sigma_{\smnu}{=}~1.163$ to $0.112$ eV --- an order of magnitude improvement 
    over the power spectrum}.}
\label{fig:bk_fish}
\end{center}
\end{figure}

\begin{figure}
\begin{center}
    \includegraphics[width=\textwidth]{figs/quijote_pbkFisher_freeMmin_dmnu_fin_kmax05.pdf}
    \caption{Same as Figure~\ref{fig:bk_fish} but for $k_{\rm max} = 0.5~h/{\rm Mpc}$.
    Again, the bispectrum substantially improves constraints on all cosmological parameters 
    over the power spectrum. {\em For $\smnu$, the bispectrum improves $\sigma_{\smnu}$ from 
    $0.319$ to $0.0239$ eV --- over an order of magnitude improvement over the power spectrum}.}
\label{fig:bk_fish_kmax}
\end{center}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% forecast table
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{table}
    \caption{Cosmological parameter constraints from the redshift-space halo power spectrum (top) and bispectrum (bottom) 
    for different values of $k_{\rm max}$.} 
\begin{center} 
    \begin{tabular}{cccccccccc} \toprule
         & $k_{\rm max}$ & $\smnu$ & $\Omega_m$ & $\Omega_b$ & $h$ & $n_s$ & $\sig$ & $b'$ & $M_{\rm min}$ \\
         & ({\footnotesize $h/{\rm Mpc}$}) &({\footnotesize eV}) & & & & & & & ({\footnotesize $10^{13} h^{-1}M_\odot$}) \\[3pt] \hline\hline

                    &     & 0.0 & 0.3175 & 0.049 & 0.6711 & 0.9624 & 0.834 & 1. & 3.2  \\ 
        $P_0$    & 0.2 & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ \\ 
                    & 0.3 & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ \\ 
                    & 0.4 & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ \\ 
                    & 0.5 & $\pm0.319$ & $\pm 0.0444$ & $\pm 0.0221$ & $\pm0.294$ & $\pm0.315$ & $\pm0.0430$ & $\pm0.35$ & $\pm0.13$  \\ \hline
        $B_0$  & 0.2 & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ \\ 
                            & 0.3 & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ \\ 
                            & 0.4 & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ & $\pm$ \\ 
                            %0.01029968, 0.00201679, 0.02952713, 0.03213827, 0.0124921 , 0.0238887 , 0.04594263, 0.04650724
                            & 0.5 & $\pm0.0239$ & $\pm0.0103$ & $\pm0.00202$ & $\pm0.0295$ & $\pm0.0321$ & $\pm0.0125$ & $\pm0.046$ & $\pm0.047$ \\[3pt]
    \hline
\end{tabular} \label{tab:forecast}
\end{center}
\end{table}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}
\begin{center}
    \includegraphics[width=0.9\textwidth]{figs/quijote_Fisher_dmnu_fin_sigmakmax_freeMmin.pdf} 
    \caption{Marginalized $1\sigma$ constraints of $\Om$, $\Ob$, $h$, $n_s$, $\sig$, and $\smnu$ 
    as a function of $k_{\rm max}$ for the redshift-space halo bispectrum (orange) and power 
    spectrum (blue). Though not included in the figure, we marginalize over $b'$ and $M_{\rm min}$
    in our forecast.\ch{more}}
\label{fig:fish_kmax}
\end{center}
\end{figure}

\subsection{$\smnu$ and other Cosmological Parameter Forecasts} \label{sec:forecasts}
We demonstrate in the previous section with the HADES simulations, that 
the bispectrum helps break the $\smnu$--$\sig$ degeneracy, a major 
challenge in precisely constraining $\smnu$ with the power spectrum. 
This establishes the bispectrum as a promising probe for $\smnu$. However, 
we are ultimately interested in determining the constraining power of the 
bispectrum for an analysis that include cosmological parameters beyond 
$\smnu$ and $\sig$--- \emph{i.e.} $\Om$, $\Ob$, $h$, and $n_s$. The Quijote 
suite of simulations is \emph{specifically} designed to answer this question
using Fisher matrix forecast.

First, the Quijote suite includes $15,000$ realizations run at a fidicial 
cosmology: $\smnu{=}0.0$eV, $\Om{=}0.3175, \Ob{=}0.049, n_s{=}0.9624, h{=}0.6711$, 
and $\sig=0.834$ (see Table~\ref{tab:sims}. This allows us to robustly estimate 
the covariance matrix of the bispectrum, $\bfi{C}$, which has ${\sim}1,800$ 
triangle configurations (Figure~\ref{fig:bk_cov}). Second, the Quijote suite 
includes $500$ fixed-pair realizations evaluated at $13$ different cosmologies,
each a small step away from the fiducial cosmology parameter values along one 
parameter (Section~\ref{sec:hades} and~Table~\ref{tab:sims}). These realizations 
allow us to precisely estimate the derivatives of the bispectrum with respect 
to each of the cosmological parameters.

Since their introduction to cosmology over two decades ago, Fisher Information 
matrices have been ubiquitously used to forecast the constraining power of future 
experiments~\citep[\emph{e.g.}][]{jungman1996,tegmark1997a,dodelson2003,heavens2009,verde2010}. 
Defined as 
\beq 
F_{ij} = - \bigg \langle \frac{\partial^2 \mathrm{ln} \mathcal{L}}{\partial \theta_i \partial \theta_j} \bigg \rangle,
\eeq
where $\mathcal{L}$ is the likelihood, the Fisher matrix for the bispectrum can 
be written as 
\beq \label{eq:fullfish} 
F_{ij} = \frac{1}{2}~\mathrm{Tr} \Bigg[\bfi{C}^{-1}\parti{\bfi{C}}\bfi{C}^{-1}\partj{\bfi{C}} + \bfi{C}^{-1} \left(\parti{\overline{B}_0}\partj{\overline{B}_0}^T + \parti{\overline{B}_0}^T \partj{\overline{B}_0} \right)\Bigg].
\eeq
Since we assume that the $B_0$ likelihood is Gaussian, including the first 
term in Eq.~\ref{eq:fullfish} runs the risk of incorrectly including information 
from the covariance already included in the mean~\citep{carron2013}. We, therefore,
conservatively neglect the first term and calculate the Fisher matrix, 
\beq \label{eq:fisher}
F_{ij} = \frac{1}{2}~\mathrm{Tr} \Bigg[\bfi{C}^{-1} \left(\parti{\overline{B}_0}\partj{\overline{B}_0}^T + \parti{\overline{B}_0}^T \partj{\overline{B}_0} \right)\Bigg],
\eeq
directly with $\bfi{C}$ and $\partial B_0/\partial \theta_i$ along each cosmological 
parameter from the Quijote simulations. For $\Om$, $\Ob$, $h$, $n_s$, and $\sig$, 
we estimate 
\beq \label{eq:dbkdt} 
\frac{\partial \overline{B}_0}{\partial \theta_i} \approx \frac{\overline{B}_0(\theta_i^{+})-\overline{B}_0(\theta_i^{-})}{\theta_i^+ - \theta_i^-}. 
\eeq
Meanwhile, for $\smnu$, where the fiducial value is 0.0 eV and we cannot have 
negative $\smnu$, we use the Quijote simulations at $\smnu^+$, $\smnu^{++}$, 
$\smnu^{+++}=0.1, 0.2, 0.4$ eV (Table~\ref{tab:sims}) to estimate: 
\beq \label{eq:dbkdmnu} 
\frac{\partial \overline{B}_0}{\partial \smnu} \approx \frac{-21\overline{B}_0(\smnu^{\rm fid}) + 
32 \overline{B}_0(\smnu^{+}) - 12 \overline{B}_0(\smnu^{++}) + \overline{B}_0(\smnu^{+++})}{1.2}. 
\eeq
By using these $N$-body simulations, instead of analytic methods (\emph{e.g.} 
perturbation theory), we exploit the accuracy of numerical simulations in the 
nonlinear regime and rely on fewer assumptions and approximations. 
\ch{something about quanity the information content of the bispectrum in the nonlinear regime unprecedented.} 
We discuss subtleties of the bispectrum derivatives in Appendix~\ref{sec:numerical} and 
discuss tests of convegence in Appendix~\ref{sec:numerical}. 

We present the constraints on $\smnu$ and other cosmological parameters 
$\{\Om, \Ob, h, n_s, \sig\}$ derived from the redshift-space halo bispectrum 
Fisher matrix (Eq.~\ref{eq:fisher}) in Figures~\ref{fig:bk_fish} and~\ref{fig:bk_fish_kmax}. 
We include Fisher constraints for the redshift-space halo power spectrum 
monopole in blue for comparison. The contours mark the $68\%$ and $95\%$ 
confidence interals. For both the power spectrum and bispectrum, we set 
$k_{\rm max} = 0.5~h/{\rm Mpc}$. We also include in our Fisher cosntraints, 
parameters $b'$, a free amplitude scaling factor, and $M_{\rm min}$, the halo 
mass limit. These parameters serve as a simplistic bias model and by marginalizing 
over them we ensure that our Fisher constraints do not include extra constraining 
power from the difference in bias/number density in the different Quijote 
cosmologies used to calculate $\partial \overline{B}_0/\partial \theta_i$. $b'$ is a 
multiplicative factor so $\partial \overline{B}_0/\partial b' = \overline{B}_0$.
Meanwhile, we numerically estimate $\partial \overline{B}_0/\partial M_{\rm min}$ 
using $\overline{B}_0$ evaluated at $M_{\rm min}{=}3.3$ and 
$3.1\times10^{13}h^{-1}M_\odot$, with all other parameters fixed. In Table~\ref{tab:forecast}, we list the 
parameter constraints for $P_0(k < k_{\rm max}=0.5~h/{\rm Mpc})$ and
$B_0(k_1, k_2, k_3 < k_{\rm max}=0.5~h/{\rm Mpc})$.

The bispectrum substantially improves constraints on all of the parameters 
over the power spectrum (Figure~\ref{fig:bk_fish} and Table~\ref{tab:forecast}). 
More precisely, the bispectrum improves the marginalized $\Om$, $\Ob$, $h$, 
$n_s$, and $\sig$ constraints by factors of $\sim$4, 11, 10, 10, and 3 with 
respect to their power spectrum constraints. {\em For $\smnu$, the bispectrum 
improves the constraint from $\sigma_{\smnu}{=}~0.319$ to $0.0239$ eV --- over 
an order of magnitude improvement over the power spectrum}.

Even at lower $k_{\rm max} < 0.5~h/{\rm Mpc}$, the bispectrum significantly 
improves cosmological parameter constraints. We compare the marginalized 
$1\sigma$ constraints of $\Om$, $\Ob$, $h$, $n_s$, $\sig$, and $\smnu$ as 
a function of $k_{\rm max}$ for $B_0$ (orange) and $P_0$ (blue) in Figure~\ref{fig:fish_kmax}. 
\ch{write this once we have to updated powerspectrum calculations}. 

discussing the results  
\bitem 
\item emphasize that this is only for a 1 Gpc box so our constraints will be so much better
\item how does the bispectrum do so much better? --- \emph{i.e.} triangles that contribute 
    most fisher information
\item redshift-space helps us out (refer to appendix) 
\eitem 

The results above definitively show that the bispectrum has significant 
constraining power in the weakly nonlinear regime ($k > 0.1~h/{\rm Mpc}$) 
beyond the power spectrum. Our results also demonstrated the potential of 
the bispectrum in constraining $\smnu$ (an order of magnitude improvement over 
$P_0$). Below, we underline a few caveats of the results we present above. 
First, the parameter constraints were derived using the Fisher matrix. This 
assumes 
\bitem
\item mention the caveats of fisher forecasts
\item emphasize the lack of bananas in the contours
\item convergence concerns (refer to appendix) 
\item $\smnu$ dependence of derivatives along $\smnu$. (refer to appendix) 
\item take Fisher forecasts with a grain of salt 
\eitem 

Another caveat is that our parameter constraints were derived using the power 
spectrum and bispectrum of halo in a periodic box. We do not consider a 
realistic survey geometry or radial selection function. A realistic selection 
function will smooth out the triangle configuration dependence and consequently 
degrade the constraining power of the bispectrum. In \cite{sefusatti2005}, for 
instance, they find that the signal-to-noise of the bispectrum is significantly 
reduced once survey geometry is included in their forecast. Survey geometry, 
however, also degrade the signal-to-noise of their power spectrum forecasts. 
Hence, with the order of magnitude improve in the $\smnu$ constraining power 
of the bispectrum, even with survey geometry, including the bispectrum will 
improve $\smnu$ constraints. 

Although we focus on the halo bispectrum and power spectrum in this paper, 
constraints on $\smnu$ will ultimately be derived from the distribution of 
galaxies. Besides the cosmological parameters, bias and nuisance parameters 
that allow us to marginalize over the galaxy---halo connection need to be
incorporated to forecast $\smnu$ and other cosmological parameter constraints 
for the galaxy bispectrum. Although we include a \emph{naive} bias model 
through $b'$ and $M_{\rm min}$, this is insufficient to describe how galaxies
occupy halos. A more realistic bias model such as a halo occupation distribution 
(HOD) model involve extra parameters that describe the distribution of central 
and satellite galaxies in halos~\citep[\emph{e.g.}][]{zheng2005,leauthaud2012a,tinker2013,zentner2016,vakili2019}. 
\ch{maybe something about Uros and Nick's model involving a lot of parameters.}
Marginalizing over these extra parameters, will likely reduce the constraining 
power at high $k$. Even if the constraining power at high $k$ is reduced, the
bispectrum still offers significant improvements over the power spectrum at 
$k_{\rm max} \sim 0.2$. Jointly analyzing power spectrum and bispectrum will 
help constrain these extra bias parameters. Furthermore, we again emphasize that
the constraints we present in this paper is for a $1h^{-1}{\rm Gpc}$ box. In 
Hahn et al. (in preparation), we will include a realistic HOD model and quantify 
the information content and constraining power of a joint galaxy power spectrum 
and bispectrum analysis. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Section   
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Summary} 

\ch{talk about DESI, PFS, WFIRST} 

\section*{Acknowledgements}
It's a pleasure to thank 
    Enea Di Dio, 
    Daniel Eisenstein, 
    Simone Ferraro, 
    Shirley Ho, 
    Emmaneul Schaan, 
    Zachary Slepian, 
    David N.~Spergel, 
    and Benjamin D.~Wandelt
    for valuable discussions and comments. 

\appendix

\begin{figure}
\begin{center}
    \includegraphics[width=0.95\textwidth]{figs/haloBk_amp_kmax05_rsd_comparison.pdf}
    \caption{Comparison of the fiducial HADES simuluations real and redshift-space halo
    bispectrum for triangle configurations with $k_1, k_2, k_3 \leq k_{\rm max} = 0.5 h/{\rm Mpc}$ 
    (blue and orange respectively). We mark equilateral triangle configurations (empty 
    triangle marker) along with their side lengths $k$.
    }
\label{fig:real_vs_rsd}
\end{center}
\end{figure}
\section{Redshift-space Halo Bispectrum} 
\ch{do we want to keep this section?} 

\section{Fisher Forecasts using $N$-body simulations} \label{sec:numerical}
The two key elements in calculating the Fisher matrices we use in our forecasts
are the bispectrum covariance matrix ($\bfi{C}$; Figure~\ref{fig:bk_cov}) and 
the derivatives of the bispectrum along the cosmological and nuisance parameters, 
$\partial B_0/\partial \theta_i$ (Section~\ref{sec:forecasts}). We compute 
both these elements directly using the $N$-body simulations of the Quijote suite 
(Section~\ref{sec:hades}). This takes advantage of the $N$-body simulations and 
allows us to accurately quantify the constraining power of the bispectrum that 
come from the nonlinear regime. However, to trust our forecast, we must ensure that 
both $\bfi{C}$ has converged and that the numerical calculated 
$\partial B_0/\partial \theta_i$ do not introduce any biases. Below, we tests 
the convergence of $\bfi{C}$ and $\partial B_0/\partial \theta_i$ and discuss
some of the subtleties and caveats of numerically calculating $\partial B_0/\partial \theta_i$ 
from the Quijote simulations. 

To estimate $\bfi{C}$, we use 15,000 Quijote $N$-body simulations at the 
fiducial cosmology. This is a \emph{significantly} larger number of simulations 
than previous bispectrum analyses; however, we also consider a larger number
of triangle configurations --- $1898$ triangles out to $k_{\rm max} = 0.5~h/{\rm Mpc}$. 
For reference, the recent \cite{gil-marin2017} analysis used 2048 simulations 
to estimate the covariance matrix of the bispectrum with $825$ configurations. 
We, therefore, check the convergence of $\bfi{C}$ by varying $N_{\rm fid}$, 
the number of simulations used to estimate $\bfi{C}$, and examining whether 
this significantly impacts the Fisher parameter constraints. We present 
$\sigma_\theta(N_{\rm fid})/\sigma_\theta(N_{\rm fid} = 15,000)$, the ratio of 
the 1$\sigma$ Fisher constraint for $\theta = \Om$, $\Ob$, $h$, $n_s$, $\sig$, 
and $\smnu$ calculated with $N_{\rm fid}$ over the constraint calculated with 
$N_{\rm fid} = 15,000$, as a function of $N_{\rm fid}$ (Figure~\ref{fig:converge} 
left panel). The 1$\sigma$ Fisher constraints on the parameters 
vary by $<10\%$ for $N_{\rm fid} > 7000$; in fact, the constraints vary by 
$<1\%$ for $N_{\rm fid} > 14,000$. Hence, we conclude that we have a sufficient 
number of simulations to estimate the bispectrum $\bfi{C}$ and our forecasts 
are robust to the convergence of $\bfi{C}$. 

We estimate $\partial B_0/\partial \theta_i$ numerically using 13 sets of 
$N_{\rm fp} = 500$ fixed paired simulations~(Table~\ref{tab:sims}). To check 
the convergence of $\partial B_0/\partial \theta_i$ and its impact on our forecast 
we present the ratio of the 1$\sigma$ Fisher constraint for $\theta$ calculated 
using $N_{\rm fp}$ simulations over the constraint calculated with $N_{\rm fp} = 500$, 
$\sigma_\theta(N_{\rm fp})/\sigma_\theta(N_{\rm fp} = 500)$, as a function of 
$N_{\rm fp}$ (Figure~\ref{fig:converge} right panel). Unlike $\sigma_\theta(N_{\rm fid})$, 
$\sigma_\theta(N_{\rm fp})$ depend significantly on $\theta$. For instance, 
$\sigma_\theta$ for $\sig$ and $\Om$ vary by $< 10\%$ for $N_{\rm fp} > 300$ 
and $< 2\%$ for $N_{\rm fp} > 450$. $\sigma_\theta$ for the other parameter 
vary significantly more. Nonetheless, for $N_{\rm fp} > 400$ and $450$ they vary by 
$< 10$ and $5\%$, respectively. 
For $\Om$, $\Ob$, $h$, $n_s$, $\sig$, and $M_{\rm lim}$ we estimate 
$\partial B_0/\partial \theta_i$ using a centered difference approximation 
(Eq.~\ref{eq:dbkdt}). However, for $\smnu$, where we cannot have values below 
0.0 eV, we cannot estimate the derivative with the same method. If we use the 
forward difference approximation, 
\beq 
\frac{\partial \overline{B}_0}{\partial \smnu} \approx \frac{\overline{B}_0(\smnu^{\rm fid}+\delta \smnu) - \overline{B}_0(\smnu^{\rm fid})}{\delta \smnu}, 
\eeq
the error goes as $\mathcal{O}(\delta \smnu)$. Instead, we use Eq.\ref{eq:dbkdmnu} 
which provides a $\mathcal{O}(\delta \smnu^2)$ order approximation. In our 
$\partial B_0/\partial \smnu$ approximation, we use the Quijote simulations at 
$\smnu^{+}$, $\smnu^{++}$, and $\smnu^{+++}$. However, if we exclude the simulations
at $\smnu^{+++}$, the $\sigma_{\smnu} = 0.112$ and $0.0238$ eV constraints for 
$k_{\rm max} = 0.2$ and $0.5~h/{\rm Mpc}$ from Section~\ref{sec:forecasts} increase 
to $\sigma_{\smnu} = 0.125$ and $0.0288$ eV. Constraints from the power spectrum 
also increase so the relative improvement from the bispectrum remains roughly the 
same. We compare $\partial \log B(k_1, k_2, k_3)/\partial M_\nu$ (right) and 
$\partial \log P(k)/\partial M_\nu$ (left), computed using Eq.\ref{eq:dbkdmnu} (blue), 
excluding $\smnu^{+++}$ (orange), and the forward difference approximation (green) in
Figure~\ref{fig:dPBdmnu}. 



Hence we conclude that the derivatives have 
sufficiently converged and robust for our forecasts.


\begin{figure}
\begin{center}
    \includegraphics[width=0.8\textwidth]{figs/quijote_bkFisher_convergence_dmnu_fin_kmax05.pdf}
    \caption{{\bf Left}: The ratio of the 1$\sigma$ Fisher constraint for $\theta=\Om$, 
    $\Ob$, $h$, $n_s$, $\sig$, and $\smnu$ calculated using $N_{\rm fid}$ Quijote 
    simulations over the constraint calculated with all 15,000 simulations, 
    $\sigma_\theta(N_{\rm fid})/\sigma_\theta(N_{\rm fid} = 15,000)$, as a 
    function of $N_{\rm fid}$. The $N_{\rm fid}$ simulations are used to estimate 
    $\bfi{C}$ used to calculate the Fisher matrix~(Eq.~\ref{eq:fisher}). The Fisher
    parameter constraints vary by $<10$ and $1\%$ for $N_{\rm fid} > 7000$ and 
    $14,000$, respectively. 
    {\bf Right}: The ratio of the 1$\sigma$ Fisher constraint for $\theta$ 
    calculated using  $N_{\rm fp}$ simulations over the constraint calculated with 
    all 500 fixed paired simulations, $\sigma_\theta(N_{\rm fp})/\sigma_\theta(N_{\rm fp} = 500)$, 
    as a function of $N_{\rm fp}$. The $N_{\rm fp}$ fixed paired simulations are 
    used to numerically estimate $\partial B_0/\partial \theta_i$ in Eq.~\ref{eq:fisher}. 
    Although $\sigma_\theta(N_{\rm fp})/\sigma_\theta(N_{\rm fp} = 500)$ vary among 
    the parameters, for $N_{\rm fp} > 400$ and $450$ they vary by $< 10$ and $5\%$, 
    respectively. Hence, {\em we have a sufficient number of simulations to estimate 
    $\bfi{C}$ and the derivatives of the bipsectrum and our forecasts are robust to 
    their convergence.} 
    }
\label{fig:converge}
\end{center}
\end{figure}

\begin{figure}
\begin{center}
    \includegraphics[width=\textwidth]{figs/quijote_dPBdMnu_dmnu.pdf} 
    \caption{Comparison of $\partial \log B(k_1, k_2, k_3)/\partial M_\nu$ (right) 
    and $\partial \log P(k)/\partial M_\nu$ (left), computed using Eq.\ref{eq:dbkdmnu} (blue), 
    excluding $\smnu^{+++}$ (orange), and the forward difference approximation (green). 
    }
\label{fig:dPBdmnu}
\end{center}
\end{figure}
\bibliographystyle{yahapj}
\bibliography{emanu} 
\end{document}
