LATEX       = pdflatex
BASH        = bash -c
ECHO        = echo
RM          = rm -rf
TMP_SUFFS   = pdf aux bbl blg log dvi ps eps out toc lof lot
CHECK_RERUN =

all: emanu.pdf

vc.tex: Makefile ../../.git/logs/HEAD
	@echo "%%% This file is generated by the Makefile." > vc.tex
	@git config --get remote.origin.url | sed "s/\.git//" | sed "s=^=\\\\\\newcommand{\\\\giturl}{\\\\url{=" | sed "s/.*/&}}/" >> vc.tex
	@git log -1 --date=short --format="format:\\newcommand{\\githash}{%h}\\newcommand{\\gitdate}{%ad}\\newcommand{\\gitauthor}{%an}" >> vc.tex
	@echo "" >> vc.tex

emanu.pdf: *.tex vc.tex
	${LATEX} emanu 
	bibtex emanu 
	${LATEX} emanu
	( grep Rerun emanu.log && ${LATEX} emanu ) || echo "Done."
	( grep Rerun emanu.log && ${LATEX} emanu ) || echo "Done."

rs_email.pdf: *.tex
	${LATEX} rs_email 

clean:
	${RM} $(foreach suff, ${TMP_SUFFS}, emanu.${suff})
